---
title: "wet lab QC"
author: "Nate Olson"
date: '`r Sys.Date()`'
always_allow_html: yes
output:
  pdf_document: default
  html_document: default
---
```{r echo=FALSE, message=FALSE}
library(ProjectTemplate)
cwd <- getwd()
setwd("../")
load.project()
setwd(cwd)
```


### Wetlab QC  

### 16S PCR Concentration Post-Cleanup
```{r echo = FALSE}
#tstWetLabQC %>% left_join(tstPcrSampleMetaData) %>% .$conc_ngml %>% summary()
## Joining, by = c("pcr_16S_plate", "pos")
##   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  -1.117  12.960  20.670  19.280  25.750  49.600 
```
The initial 16S PCR product was first verified for amplification and amplicon size using gel electrophoresis \@ref(fig:gel_16S).  
The concentration of the PCR product was also assessed using picogreen, samples with negative measured concentation values (excluding no template controls (NTC)) were also check using Qubit. 
The DNA concentration of the 16S PCR product after clean up  samples after ranged from below the limit of detection to 49.6 ng/ml \@ref(fig:16S_pcr_quant). 
The DNA concentration of samples with low DNA concentration measured using picrogreen ( < 1 $ng/\mu L$.) was also measured using Qubit (Table __QUBIT__). 
Only one sample had an undetectable DNA concentration using the Qubit. 
Gel electrophoresis of the 16S PCR products indicated that the sample failed to amplify during the initial PCR \@ref(fig:16S_pcr_gel). 
__TODO__ Need gel info - gel concentration, run info - V and time, ladder info - manufacturer and band sizes.
Despite failure to amplify the sample was processed through the sequence pipeline with the rest of the samples.

```{r gel_16S, echo=FALSE, fig.cap="Agarose gel electrophoresis of 16S PCR products."}
knitr::include_graphics("../img/1st_16S_PCR_P1_P2_Gel_20160224.tif")
```

```{r 16S_pcr_quant, fig.cap = "Picogreen DNA concentration measurements of 16S PCR product after clean-up."}
tstWetLabQC %>% left_join(tstPcrSampleMetaData) %>% 
      mutate(titration = as.factor(titration)) %>% 
      ggplot(aes(x = biosample_id, y = conc_ngml, color = titration)) + 
      geom_point() +
      theme_bw() + 
      labs(x = "Biological Replicate", 
           y = "DNA Concentration (ng/mL)",
           color = "Titration Factor")
```

```{r}
tstWetLabQC %>% left_join(tstPcrSampleMetaData) %>% 
      filter(!is.na(qubit), biosample_id != "NTC") %>% 
      select(biosample_id, titration, pcr_16S_plate, pos, conc_ngml, qubit) %>% 
      kable()
```


#### Index PCR  
* Post clean-up DNA concentrations
__TODO__ Script to extract concentration information

#### Normalization
* Picogreen concentration
__TODO__ Script to extract concentration information
excel file 16032_NIST_norm_15uL.xlsx

#### Library Pooling
* Assay methods   
* QC  
    * methods  
    * results 

