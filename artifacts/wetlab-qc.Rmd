---
title: "wet lab QC"
author: "Nate Olson"
date: '`r Sys.Date()`'
always_allow_html: yes
output:
  pdf_document: default
  html_document: default
---
```{r setup, warning=FALSE, message=FALSE, echo = FALSE}
library(savR)
library(mgtst)
library(readr)
library(tidyr)
library(stringr)
library(magrittr)
library(knitr)
library(devtools)
library(sapkotaUtils)
library(ggplot2)
library(dplyr)
library(tibble)
library(purrr)
library(DT)
library(Rqc)
library(ShortRead)
library(dada2)
```


### Wetlab QC  
* sample concentration results summary  
    + bacterial quant (http://www.zymoresearch.com/dna/dna-analysis/femto-bacterial-dna-quantification-kit)  
    

* Mixture QC  
    + ERCC qPCR  
* 16S PCR QC
   + Gel  
        - Need gel info - gel concentration, run info - V and time, ladder info - manufacturer and band sizes. 

The initial 16S PCR product was first verified for amplification and amplicon size using gel electrophoresis \@ref(fig:gel_16S).  
The concentration of the PCR product was also assessed using pico green, samples with negative measured concentation values (excluding no template controls (NTC)) were also check using Qubit. Only one of the 180 samples did not successfully amplify E01JH0016 dilution 5 (postion F9, plate 1).  All but one of the no template control concentration measurements was less than 1 $ng/ \mu l$, when the one sample was checked with Qubit the concentration was too low to measure.   


```{r gel_16S, echo=FALSE, out.width = 600, fig.cap="Agarose gel electrophoresis of 16S PCR products."}
#knitr::include_graphics('../img/1st_16S_PCR_P1_P2_Gel_20160224.tif')
```

```{r 16S_pico, fig.cap= "Concentration measured using picrogreen of 16S PCR products post-cleanup. Low concentration samples were remeasured using QUBIT, and concentration values (ng/ul) are indicated as text near pico green data point."}
pcr_16S_pico %<>% filter(pos != "Well", !is.na(pos)) 
pcr_16S_qc <- sample_sheet %>% filter(barcode_lab == "JHU", seq_lab == "JHU") %>% 
      rename(pcr_16S_plate = "plate") %>% 
      select(sampleID, dilution, plate, pos) %>% 
      mutate(pos = str_replace(pos, "_","")) %>% right_join(pcr_16S_pico)

pcr_16S_qc %>% ggplot() + 
      geom_point(aes(x = factor(dilution), y = conc_ngul)) + theme_bw() + 
      facet_wrap(~sampleID, scales = "free_x", nrow = 1) +
      geom_text(aes(x = factor(dilution), y = conc_ngul, label = qubit),nudge_y = -0.25, nudge_x = 1)
```





#### Index PCR  
* Post clean-up DNA concentrations

#### Normalization
* Picogreen concentration

#### Library Pooling
* Assay methods   
* QC  
    * methods  
    * results 

```{r post_clean_16S}
# Concentraiton results after PCR clean-up
pcr_16S_pico %>% DT::datatable()
```

__NOTES__
Modify names for consistency and merging with sample sheet
summary plot showing outliers
plot of standard curve

__END of NOTES__